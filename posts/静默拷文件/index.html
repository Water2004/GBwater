<!DOCTYPE html>
<html lang="cn">
    <head>
    <meta charset="UTF-8">

    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="generator" content="Hugo 0.80.0" />

    
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <meta name="format-detection" content="telephone=no, date=no, address=no, email=no" />
    
    <meta http-equiv="Cache-Control" content="no-transform" />
    
    <meta http-equiv="Cache-Control" content="no-siteapp" />

    <link rel="stylesheet" href="/css/bootstrap.min.css">
<link rel="stylesheet" href="/css/remixicon/remixicon.css"><link rel="stylesheet" href="/css/tony.min.2cd909c3b2b4f0eb1f6b8dbe02a8be4ed8a7456895a39f284818ed1e771073c6.css" integrity="sha256-LNkJw7K08Osfa42+Aqi+TtinRWiVo58oSBjtHncQc8Y="/>

    <link rel="shortcut icon" href="/images/t.jpg" type="image/x-icon" />
    <title>静默拷文件</title>

    <meta name="author" content="GBwater" /><meta name="description" content="" />

    
    <link rel="canonical" href="https://gbwater.ga/posts/%E9%9D%99%E9%BB%98%E6%8B%B7%E6%96%87%E4%BB%B6/" />
    


</head>

    <header id="header-div" class="tony-header-fixed">

    <div class="header-div1">
        <a href="https://gbwater.ga/" style="display:inline-block;">
            <img src="/images/t.jpg">
        </a>
    </div>
    <div class="header-div2">
    <a href="/"><button class="btn btn-light">主页</button></a>
    <a href="/tags/"><button class="btn btn-light">标签</button></a>
    <a href="/categories/"><button class="btn btn-light">分类</button></a>
    <a href="/archives/"><button class="btn btn-light">归档</button></a>
    <a href="/about/"><button class="btn btn-light">关于</button></a>
    <a href="/links/"><button class="btn btn-light">友链</button></a>
    
</div>
</header>
    <body>
        
    <div id="post-container">
    <div class="grid grid-centered">
        <div id="grid-cell" class="grid-cell">
            
                <div class="single-left">
                    
        
        
        
        
            
            
            
            <div class="index-div">
                <div class="single-index">
                    <h4>
                        <i class="ri-list-check-2"></i>
                        
                    </h4>
                </div>  
                <ul id="article-index" class="index-ul">
                    
                        
                        
                            
                                
                                
                                <a href="#%e9%87%8d%e4%b8%ad%e4%b9%8b%e9%87%8dbr">
                                    <li style="padding-left:23px" class="">
                                        <i class="ri-checkbox-blank-circle-line"></i>
                                        &nbsp;&nbsp;重中之重

                                    </li>
                                </a>
                            
                        
                    
                        
                        
                            
                                
                                
                                <a href="#%e7%ae%80%e4%bb%8b">
                                    <li style="padding-left:23px" class="">
                                        <i class="ri-checkbox-blank-circle-line"></i>
                                        &nbsp;&nbsp;简介
                                    </li>
                                </a>
                            
                        
                    
                        
                        
                            
                                
                                
                                <a href="#v-500%e6%9b%b4%e6%96%b0%e5%86%85%e5%ae%b9">
                                    <li style="padding-left:23px" class="">
                                        <i class="ri-checkbox-blank-circle-line"></i>
                                        &nbsp;&nbsp;v 5.0.0更新内容
                                    </li>
                                </a>
                            
                        
                    
                        
                        
                            
                                
                                
                                <a href="#%e4%bd%bf%e7%94%a8%e8%af%b4%e6%98%8e">
                                    <li style="padding-left:23px" class="">
                                        <i class="ri-checkbox-blank-circle-line"></i>
                                        &nbsp;&nbsp;使用说明
                                    </li>
                                </a>
                            
                        
                    
                        
                        
                            
                                
                                
                                <a href="#setuptxt%e9%85%8d%e7%bd%ae%e9%80%89%e9%a1%b9">
                                    <li style="padding-left:23px" class="">
                                        <i class="ri-checkbox-blank-circle-line"></i>
                                        &nbsp;&nbsp;setup.txt”配置选项
                                    </li>
                                </a>
                            
                        
                    
                        
                        
                            
                                
                                
                                <a href="#%e8%bf%90%e8%a1%8c%e6%88%aa%e5%9b%be">
                                    <li style="padding-left:23px" class="">
                                        <i class="ri-checkbox-blank-circle-line"></i>
                                        &nbsp;&nbsp;运行截图
                                    </li>
                                </a>
                            
                        
                    
                        
                        
                            
                                
                                
                                <a href="#%e4%b8%8b%e8%bd%bd">
                                    <li style="padding-left:23px" class="">
                                        <i class="ri-checkbox-blank-circle-line"></i>
                                        &nbsp;&nbsp;下载
                                    </li>
                                </a>
                            
                        
                    
                </ul>
            </div>
        
                    




    
        <div>
            <div class="index-div-prev">
                <h4></h4>
                <p>
                    <a href="/posts/%E5%81%8F%E5%BE%AE%E5%88%86/" rel="next">偏微分</a>
                </p>
            </div>
        </div>
    
    
        <div>
            <div class="index-div-next">
                <h4></h4>
                <p>
                    <a href="/posts/%E7%A7%AF%E5%88%86/" rel="prev">积分</a>
                </p>
            </div>
        </div>
    

                </div>
            
            
                <div id="reading-bar"></div>
            
            <article class="article reveal">
                <div id="load">
                    <div class="article-header">
                        
    
        <span class="badge badge-pill badge-danger single-badge">
            <a href="https://gbwater.ga/categories/%E5%B7%A5%E5%85%B7" class="post-header">工具</a>
        </span>
    

<span title="预计阅读时长" class="badge badge-pill badge-danger single-badge post-header">
    4 mins
</span>
<h2 class="single-h2">静默拷文件</h2>
<div class="article-list-footer">
    <span class="article-list-date">22-07-20</span>
    <span class="article-list-divider">/</span>
    <span class="article-list-minutes">1802 Words</span>
</div>
<div class="single-line"></div>
                    </div>
                    <div class="article-content">
                        <h2 id="重中之重br">重中之重<br></h2>
<ul>
<li>
<p><font size=4> <strong>GUI版运行需要安装 .NET 4.7.2！！！</strong></font>
若未安装，请运行：“NDP472-KB4054530-x86-x64-AllOS-ENU.exe”安装<br></p>
</li>
<li>
<p><font size=4> <strong>5.0的setting.txt和其他版本的不兼容,不可互换！！！</strong></font></p>
</li>
<li>
<p>由于使用了Qt，可能会导致兼容性问题</p>
</li>
</ul>
<h2 id="简介">简介</h2>
<ul>
<li>实现在检测到<del>u盘</del>目录存在后将<del>u盘</del>目录中的文件复制到制定目录中</li>
<li>实现盘符和磁盘名称两种方法检测 <del>用来复制指定u盘的文件</del></li>
<li>复制时保留源目录结构<del>就是不仅把ppt搞出来还按原方式分文件夹</del></li>
<li>如有bitlocker锁，则等待解锁后复制<del>就是u盘有密码也可以</del></li>
<li>经测试可正确运行于Windows10（2004），其他系统本蒟蒻就不知道了<del>其实是懒得试</del><br></li>
<li>使用C++和Qt编写主程序<br></li>
<li>wpf+C# .net实现图形化 <del>（本来用的是winform+VB .net，但嫌它丑）</del><br></li>
<li>使用命令行工具“ROBOCOPY”实现相关功能 <del>本蒟蒻懒得敲</del><br></li>
<li>源代码也一并奉上，欢迎各位大神指导！如有雷同，纯属巧合<br></li>
<li>因使用此工具造成的损失本蒟蒻概不负责<del>强行甩锅，逃。。。</del><br></li>
<li>......</li>
</ul>
<h2 id="v-500更新内容">v 5.0.0更新内容</h2>
<ul>
<li>使用Qt+C++编写主程序</li>
<li>新增检测方式——磁盘名称</li>
<li>新增复制前等待选项，避让使用高峰期</li>
<li>更换bitlocker解锁检测方式，减小资源消耗</li>
</ul>
<h2 id="使用说明">使用说明</h2>
<ul>
<li><font size=4> <strong>编辑配置文件</strong></font></li>
</ul>
<ol>
<li>编辑“setup.txt”完成配置</li>
<li>运行“start无提示.vbs”或“start有提示.vbs”运行程序，等待u盘插入（切不可直接运行copy.exe!）</li>
<li>u盘插入后，程序自动复制文件</li>
<li>待u盘拔出后，检查复制出来的文件，若有需要，打开“log.txt”查看日志并进行下一步操作</li>
</ol>
<ul>
<li><font size=4> <strong>使用GUI配置工具（推荐）</strong></font></li>
</ul>
<ol>
<li>运行静默拷文件.exe，完成配置后，点击保存并启动按钮（高级选项 is useful，但不了解建议不要勾选）</li>
<li>u盘插入后，程序自动复制文件</li>
<li>待u盘拔出后，检查复制出来的文件，若有需要，可以查看日志并进行下一步操作</li>
</ol>
<ul>
<li>
<p><font size=4> <strong>“setup.txt”的填写及修改说明</strong></font></p>
<ul>
<li>请填写在提示字符的下一行（已留空，直接填在空行就好）</li>
<li>留空代表不使用该选项</li>
<li>删除时请留出空行，即各提示字符间必须留有一行空行，多了少了都不行</li>
<li>本蒟蒻已预先填写好一些内容，均可修改。但(不建议修改）的内容不建议修改及删除（大神请随意）</li>
</ul>
</li>
<li>
<p><font size=4> <strong>“start无提示.vbs”和“start有提示.vbs”</strong></font>
无提示则复制完成后不会有任何反应，有提示则复制完成后会有一“您的资料已被盗！”弹窗弹出</p>
</li>
</ul>
<h2 id="setuptxt配置选项">setup.txt”配置选项</h2>
<table border="1">
  <tr>
    <th>配置名</th>
    <th>说明</th>
    <th>填写说明</th>
    <th>样例</th>
  </tr>
  <tr>
  <td>文件源模式</td>
  <td>按何种方式检测文件源</td>
  <td>0:盘符，1:磁盘名称</td>
  <td>0</td>
  </tr>
  <tr>
    <td>文件源</td>
    <td>即从哪个目录复制，写卷标或绝对路径或磁盘名称</td>
    <td>若留空，即自动检测盘符</td>
    <td>C: D: E: F:\hhh\hhh EFI</td>
  </tr>
  <tr>
    <td>文件名</td>
    <td>即复制什么文件，可以使用“*”</td>
    <td>可以填写多个，用空格隔开<br>若留空，即复制源目录下所有文件</td>
    <td>*.ppt *.pptx</td>
  </tr>
  <tr>
    <td>目标目录</td>
    <td>即复制到哪里，记得写路径</td>
    <td>需为文件夹<br>若留空，则自动在程序目录下建立一个名为files的文件夹</td>
    <td>C:\Users\32154\Desktop</td>
  </tr>
  <tr>
    <td>文件最大限制</td>
    <td>即只复制大小不大于此限制的文件</td>
    <td>单位是字节<br>1MB=1024KB<br>1KB=1024字节</td>
    <td>0</td>
  </tr>
  <tr>
    <td>文件最小限制</td>
    <td>即只复制大小不小于此限制的文件</td>
    <td>单位是字节<br>1MB=1024KB<br>1KB=1024字节</td>
    <td>0</td>
  </tr>
  <tr>
    <td>最长的文件存在时间</td>
    <td></td>
    <td>日期或数字</td>
    <td>20180203意为只复制2018年2月3日及以后复制进文件源的文件；<br>10意为只复制10天以内复制进文件源的文件</td>
  </tr>
  <tr>
    <td>最短的文件存在时间</td>
    <td></td>
    <td></td>
    <td>如填20180203，意为只复制2018年2月3日及以前复制进文件源的文件，如填10，意为只复制10天以前复制进文件源的文件</td>
  </tr>
  <tr>
    <td>最大的最后访问日期</td>
    <td></td>
    <td>日期</td>
    <td>20180203意为只复制2018年2月3日及以后使用过的文件</td>
  </tr>
  <tr>
    <td>最小的最后访问日期</td>
    <td></td>
    <td>日期</td>
    <td>20180203意为只复制2018年2月3日及以后未使用的文件</td>
  </tr>
  <tr>
    <td>失败副本的重试次数</td>
    <td>若复制失败，重新尝试复制该文件的次数</td>
    <td>数字</td>
    <td>0</td>
  </tr>
  <tr>
    <td>两次重试间的等待时间</td>
    <td>若复制失败，下一次尝试前的等待时间</td>
    <td>数字</td>
    <td>0</td>
  </tr>
  <tr>
    <td>仅复制源目录树的前 n 层</td>
    <td>只复制文件源前n个文件夹中的文件</td>
    <td>数字</td>
    <td>5</td>
  </tr>
  <tr>
    <td>使用 n 个线程进行多线程复制</td>
    <td>同时复制多个文件</td>
    <td>n越大复制速度可能越高，但正常使用受到的影响也越大</td>
    <td>1</td>
  </tr>
  <tr>
    <td>日志文件</td>
    <td>不可修改</td>
    <td></td>
    <td>log.txt</td>
  </tr>
  <tr>
    <td>等待时间</td>
    <td>检测u盘插入与再次检测，检测到u盘插入与开始复制文件，检测bitlocker解锁与再次检测之间的时间间隔</td>
    <td>越大资源消耗越少</td>
    <td>500</td>
  </tr>
  <tr>
    <td>程序包间间隔</td>
    <td>释放低速线路上的带宽</td>
    <td>单位是毫秒(1s=1000s)复制速度会有所降低</td>
    <td>200</td>
  </tr>
  <tr>
    <td>自动建立文件夹</td>
    <td>自动在目标目录下新建文件夹并将文件存入其中</td>
    <td>1或2(1 代表建立， 2 代表不建立)</td>
    <td>1</td>
  </tr>
  <tr>
  <td>复制前的等待时间</td>
  <td>检测到磁盘可访问与开始复制之间的时间</td>
  <td>数字，单位为秒</td>
  <td>120</td>
  </tr>
</table>  
<h2 id="运行截图">运行截图</h2>
<center><img src="https://s1.ax1x.com/2020/07/22/UHSWuV.png" style="zoom:80%" /></center>
<h2 id="下载">下载</h2>
<p><a href="https://www.fengniaopan.com/#/s/5WV7fp">蜂鸟云盘</a><br>
<a href="https://github.com/water2004/Silent-Copy-From-USB-Drives">github项目地址</a></p>

                    </div>
                    
                        <div style="text-align: left; margin: 60px 0px 40px 8px; border-radius: 6px;">
    <ul class="post_tags" style="margin: 0px; padding: 0px 0px 15px; width: 100%;">
    	<li class="cat-real" style="display: inline-block; color: rgb(102, 102, 102); font-size: 1.1rem; font-weight: 600; margin: 0px; letter-spacing: 1px;">
            <a style="background-color: rgb(231, 243, 255); color: rgb(47, 148, 254); padding: 1px 12px; border-radius: 4px; font-size: 0.9rem;"></a>
        </li>
        
            <li class="cat-real" style="display: inline-block;">
                <a href="https://gbwater.ga/tags/%E7%94%B5%E6%95%99%E5%B9%B3%E5%8F%B0%E8%87%AA%E5%8A%A8%E5%8C%96%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7%E9%9B%86/" style="font-size: 0.9rem; border-radius: 4px; padding: 1px 12px;">电教平台自动化管理工具集</a>
            </li>
        
    </ul>
</div>
                    
                        <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
    
    <div id="vcomments"></div>
    <script>
    new Valine({
        el: '#vcomments' ,
        appId: '0yETd71mzQvC5kqlVGmDIVLr-gzGzoHsz',
        appKey: 'PuVvdF6GU4JvY8RXiuHWlI5W',
        notify:false, 
        verify:false, 
        avatar:'mp', 
        placeholder: 'just go go' , 
        enableQQ:true , 
        visitor:true , 
        pageSize:15 , 
        recordIP:true
    });
    </script>
                </div>
            </div>
        </div>
    </div>
</div>

    </body>
    <div>
    <a href="https://github.com/water2004" target="_blank" style="text-decoration:none">
        <div class="goup-container footer-github">
            <i class="ri-github-fill footer-github-icon"></i>
        </div>
    </a>
    <div class="footer reveal">
        
            <p>
                Copyright&nbsp;<i class="ri-copyright-line"></i>&nbsp;·&nbsp;2021&nbsp;·&nbsp;GBwater&nbsp;·&nbsp;
                <a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" style="text-decoration: none;color: inherit;font-size: 14px;font-weight: 500;">
                    CC BY-NC 4.0
                </a>
            </p>
        
        <p>
            
                Powered by <a href="https://github.com/gohugoio/hugo">Hugo</a> | Theme is <a href="https://github.com/ThemeTony/hugo-theme-tony">Tony</a>
            
        </p>
    </div>
</div>


    <script src="/js/jquery.min.js"></script><script src="/js/tony.min.21fb28b08edccb7a220a2a53f8fa67ba2f62588d04437e5a3998769b79537006.js" integrity="sha256-IfsosI7cy3oiCipT+Ppnui9iWI0EQ35aOZh2m3lTcAY="></script><script src="/js/medium-zoom.min.js"></script>
<script>
	mediumZoom(document.querySelectorAll('div.article-content img'), {
        background: '#fff'
    });
</script>


    
<script>
(function(){
	var bp = document.createElement('script');
	var curProtocol = window.location.protocol.split(':')[0];
	if (curProtocol === 'https'){
	 bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
	}
	else{
	bp.src = 'http://push.zhanzhang.baidu.com/push.js';
	}
	var s = document.getElementsByTagName("script")[0];
	s.parentNode.insertBefore(bp, s);
})();
</script>



</html>